# üêç Nome do workflow (aparece na aba "Actions")
name: Generate Snake

# ‚ö°Ô∏è Define quando o workflow ser√° executado
on:
  schedule:
    - cron: "0 0 * * *" # executa diariamente √† meia-noite (00:00 UTC)
  workflow_dispatch: # permite rodar manualmente pelo bot√£o "Run workflow"
  push:
    branches:
      - main # tamb√©m roda quando h√° push na branch main

# üîí Permiss√µes expl√≠citas para seguran√ßa e funcionamento
permissions:
  contents: read # permite ler o conte√∫do do reposit√≥rio
  pages: write # permite publicar na branch de sa√≠da (output)
  id-token: write # necess√°rio para autentica√ß√£o com GitHub Pages

# ‚öôÔ∏è Garante que s√≥ um workflow "snake" rode por vez
concurrency:
  group: generate-snake # nome do grupo de concorr√™ncia
  cancel-in-progress: true # se um novo iniciar, o anterior √© cancelado

# üß± Define o job principal
jobs:
  generate_snake:
    name: Generate and publish snake # nome exibido na interface
    runs-on: ubuntu-latest # roda num ambiente Linux fornecido pelo GitHub

    # üåç Vari√°veis de ambiente (pra evitar repetir valores no c√≥digo)
    env:
      OUTPUT_BRANCH: output # branch onde os arquivos ser√£o publicados
      BUILD_DIR: dist # pasta onde os SVGs ser√£o gerados

    # üîÑ Passos que ser√£o executados em ordem
    steps:
      # 1Ô∏è‚É£ Baixar o conte√∫do do reposit√≥rio
      - name: Checkout repository
        uses: actions/checkout@v3 # a√ß√£o oficial do GitHub pra clonar o repo
        with:
          fetch-depth: 0 # pega o hist√≥rico completo (necess√°rio pra gerar a snake corretamente)

      # 2Ô∏è‚É£ Limpar a pasta dist (evita lixo de execu√ß√µes anteriores)
      - name: Clean dist
        run: rm -rf ${{ env.BUILD_DIR }} || true

      # 3Ô∏è‚É£ Gerar os arquivos SVG da anima√ß√£o
      - name: Generate the snake animation
        uses: Platane/snk@v3 # a√ß√£o do criador da "snake" (Platane)
        with:
          github_user_name: NattisChaos # usa automaticamente o nome do dono do reposit√≥rio
          outputs: | # define os arquivos que ser√£o gerados
            dist/github-contribution-grid-snake.svg
            dist/github-contribution-grid-snake-dark.svg?palette=github-dark

      # 4Ô∏è‚É£ (Opcional) Se der erro, envia os arquivos gerados como artefato pra depura√ß√£o
      - name: Upload artifact (for debugging)
        if: failure() # s√≥ roda se o passo anterior falhar
        uses: actions/upload-artifact@v4
        with:

          name: snake-dist
          path: ${{ env.BUILD_DIR }}
          